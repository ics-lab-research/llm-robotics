# Task 4: Avoid Obstacles During Motion
def avoid_obstacles():
	local start_position = [0.0, -1.57, 1.57, 0.0, 1.57, 0.0]
	local waypoint_around_obstacle = [0.4, -1.2, 1.2, -0.3, 1.3, 0.2]
	local end_position = [0.6, -1.2, 1.2, 0.0, 1.57, 0.0]

	while (True):
		# Check if path is safe (mock safety check)
		def is_safe_position(pos):
		    if pos[0] > 0.5:
		        popup("Warning: Path is restricted!", warning=True)
		        return False
			else:
			    return True
			end
		end

		movej(start_position, a=1.2, v=0.25)

		if is_safe_position(waypoint_around_obstacle):
		    movej(waypoint_around_obstacle, a=1.2, v=0.25)
		else:
		    popup("Cannot proceed to waypoint, obstacle detected!", warning=True)
			halt
		end

		if is_safe_position(end_position):
		    movej(end_position, a=1.2, v=0.25)
		else:
		    popup("Cannot reach destination, obstacle in path!", warning=True)
			halt
		end
	end
end

avoid_obstacles()
